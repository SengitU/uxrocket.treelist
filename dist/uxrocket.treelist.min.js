/*! UX Rocket Treelist 
 *  Tree view in tables 
 *  @author Bilal Cinarli <bcinarli@gmail.com> (https://github.com/bcinarli) 
 *  @version 0.2.0 
 *  @build Thu Oct 01 2015 14:22:01 GMT+0300 (EEST) 
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?jQuery:jQuery)}(function(e){"use strict";var t,r="uxrTreelist",n={onReady:!1,onRemove:!1},s={click:"click.uxrTreelist",ready:"uxrready.uxTreelist",collapsed:"uxrcollapsed.uxTreelist",expanded:"uxrexpanded.uxTreelist",leafcollapsed:"uxrleafcollapsed.uxrTreelist",remove:"uxrremove.uxTreelist"},i={prefix:"uxr-",rocket:"uxRocket",data:r,name:"treelist"},a=function(t,s,i){this._name=r,this._defaults=n,this.el=t,this.$el=e(t),this.options=e.extend(!0,{},n,s,this.$el.data()),this.selector=i,this.headers=[],this.contents=[],this.init()};e.extend(a.prototype,{init:function(){this.$el.addClass("uxr-treelist-ready"),this.$rows=this.$el.find("> thead > tr, > tbody > tr, > tr"),this.prepare(),this.bindUIActions(),this.emitEvent("ready")},prepare:function(){this.getRows(),this.setHeaders(),this.setContents()},getRows:function(){var t=this,r=[];this.$rows.filter("[data-uxrtl-parent]").map(function(n){var s=e(this).data("uxrtl-parent");t.contents.push(e(this)),r.indexOf(s)<0&&(r.push(s),t.headers.push(t.$rows.filter('[data-uxrtl-id="'+s+'"]')))})},setHeaders:function(){var e=this;this.headers.map(function(t){t.addClass("uxr-treelist-header").data("uxrtl-leaves",e.$el.find('[data-uxrtl-parent="'+t.data("uxrtl-id")+'"]')),0===t.find("> .uxr-treelist-toggle").length&&t.addClass("uxr-treelist-toggle")})},setContents:function(){this.contents.map(function(e){e.addClass("uxr-treelist-content uxr-treelist-collapsed")})},bindUIActions:function(){var t=this;t.$el.on(s.click,".uxr-treelist-toggle",function(r){r.preventDefault();var n=e(this).is(".uxr-treelist-header")?e(this):e(this).parent();n.is(".uxr-treelist-expanded")?t.collapse(n):t.expand(n)}).on(s.ready,function(){t.onReady()}).on(s.remove,function(){t.onDestroy()}).on(s.expanded,".uxr-treelist-header",function(){t.onBranchExpanded(this)}).on(s.collapsed,".uxr-treelist-header",function(){t.onBranchCollapsed(this)}).on(s.leafcollapsed,".uxr-treelist-content",function(){t.onLeafCollapsed(this)})},unbindUIActions:function(){this.$el.off("."+r)},expand:function(e){e.addClass("uxr-treelist-expanded").trigger("uxrexpanded").data("uxrtl-leaves").removeClass("uxr-treelist-collapsed")},collapse:function(e){e.removeClass("uxr-treelist-expanded").trigger("uxrcollapsed").data("uxrtl-leaves").addClass("uxr-treelist-collapsed").filter(".uxr-treelist-header").trigger("uxrleafcollapsed")},onReady:function(){l.callback(this.options.onReady)},onBranchExpanded:function(e){this.triggerCallback(e,"expand")},onBranchCollapsed:function(e){this.triggerCallback(e,"collapse")},onLeafCollapsed:function(t){var r=e(t);r.is(".uxr-treelist-header")&&this.collapse(r)},onDestroy:function(){l.callback(this.options.onRemove)},removeClasses:function(){this.$el.removeClass("uxr-treelist-ready")},destroy:function(){return t.destroy(this.el)},emitEvent:function(e){this.$el.trigger("uxr"+e)},triggerCallback:function(t,r){var n=e(t),s=n.data("on-"+r)||!1;l.callback(s)}});var l={callback:function(e){if("function"==typeof e)e.apply(this);else if(e!==!1){for(var t=/([a-zA-Z._$0-9]+)(\(?(.*)?\))?/.exec(e),r=t[1].split("."),n=t[3]?t[3]:"",s=r.pop(),i=r[0]?window[r[0]]:window,a=1;a<r.length;a++)i=i[r[a]];return i[s](n)}},getStringVariable:function(e){var t;if(e.indexOf(".")>-1){for(var r=e.split("."),n=window[r[0]],s=1;s<r.length;s++)n=n[r[s]];t=n}else t=window[e];return t},getClassname:function(e){return i.prefix+i.name+"-"+i.classes[e]}};t=e.fn.treelist=e.fn.uxrtreelist=e.uxrtreelist=function(t){var r=this.selector;return this.each(function(){e.data(this,i.data)||e.data(this,i.data,new a(this,t,r))})},t.destroy=function(t){var r=e(void 0!==t?t:".uxr-treelist-ready");r.each(function(){var t=e(this),r=t.data(i.data);r.removeClasses("uxr-treelist-ready"),r.unbindUIActions(),t.removeData(i.data)})},t.version="0.2.0",t.settings=n});